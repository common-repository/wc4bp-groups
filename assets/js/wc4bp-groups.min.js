;jQuery(function(e){function n(){return{'language':{errorLoading:function(){return wc_enhanced_select_params.i18n_searching},inputTooLong:function(e){var t=e.input.length-e.maximum;if(1===t){return wc_enhanced_select_params.i18n_input_too_long_1};return wc_enhanced_select_params.i18n_input_too_long_n.replace('%qty%',t)},inputTooShort:function(e){var t=e.minimum-e.input.length;if(1===t){return wc_enhanced_select_params.i18n_input_too_short_1};return wc_enhanced_select_params.i18n_input_too_short_n.replace('%qty%',t)},loadingMore:function(){return wc_enhanced_select_params.i18n_load_more},maximumSelected:function(e){if(e.maximum===1){return wc_enhanced_select_params.i18n_selection_too_long_1};return wc_enhanced_select_params.i18n_selection_too_long_n.replace('%qty%',e.maximum)},noResults:function(){return wc_enhanced_select_params.i18n_no_matches},searching:function(){return wc_enhanced_select_params.i18n_searching}}}};try{e(document.body).on('wc-enhanced-select-init',function(){e(':button.add_groups').filter(':not(.enhanced)').each(function(){e(this).click(function(){});e(this).addClass('enhanced')});e('select.wc4bp-group-search').filter(':not(.enhanced)').each(function(){var t={allowClear:e(this).data('allow_clear')?!0:!1,placeholder:e(this).data('placeholder'),minimumInputLength:e(this).data('minimum_input_length')?e(this).data('minimum_input_length'):'3',escapeMarkup:function(e){return e},ajax:{url:wc4bp_groups.ajax_url,dataType:'json',quietMillis:250,data:function(t){return{term:t,action:e(this).data('action'),security:wc4bp_groups.search_groups_nonce,exclude:e(this).data('exclude'),include:e(this).data('include'),limit:e(this).data('limit')}},processResults:function(t){var n=[];if(t){e.each(t,function(e,t){n.push({id:e,text:t})})};return{results:n}},cache:!0}};t=e.extend(t,n());e(this).select2(t).addClass('enhanced');if(e(this).data('sortable')){var r=e(this),i=e(this).next('.select2-container').find('ul.select2-selection__rendered');i.sortable({placeholder:'ui-state-highlight select2-selection__choice',forcePlaceholderSize:!0,items:'li:not(.select2-search__field)',tolerance:'pointer',stop:function(){e(i.find('.select2-selection__choice').get().reverse()).each(function(){var t=e(this).data('data').id,n=r.find('option[value="'+t+'"]')[0];r.prepend(n)})}})}})}).trigger('wc-enhanced-select-init');function r(){function r(t){var i=jQuery('#wc4bp-group-ids').data('isvariation'),n={};var r=!0;if(i===!0){e.each(t,function(e,t){var i=n[t.group_id]===undefined?'':n[t.group_id],a=i.split(',');if(a.length>0){var o=jQuery.inArray(t.variation,a);if(o>0){alert('The : '+t.group_name+' Group  have duplicate variations. Please check and try again.');r=!1;return!1}};n[t.group_id]=i+','+t.variation});return r}};function n(e){var n=e.target.name;if(n==='submitted'||n==='save'){var i=jQuery('#_wc4bp_groups_json'),t=jQuery('.wc4bp-group-item').map(function(e,t){var n=jQuery('#_membership_level',this),r=jQuery('#_membership_optional',this),i=jQuery('#_variation',this),a=jQuery('#_trigger',this);return{'group_id':jQuery(this).attr('group_id'),'group_name':jQuery(this).attr('group_name'),'member_type':n.val(),'is_optional':r.val(),'trigger':a.val(),'variation':i.val()}}).get(),a=JSON.stringify(t);i.val(a);return r(t)}};function i(){var t=jQuery('#wc4bp-group-ids').select2('data'),i=jQuery('#wc4bp-group-ids').data('isvariation');if(t){var n=jQuery('.wc4bp-group-item'),o=!1,r=n.map(function(e,t){jQuery(this).removeClass('wc4bp-group-error');return jQuery(this).attr('group_id')}).get();e.each(t,function(t,n){var l=!1,o={id:n['id'],text:n['text']};if(i===!1){e.each(r,function(e,t){if(o['id']===t){l=!0;jQuery('#wc4bp_item_'+t).addClass('wc4bp-group-error');return!1}})}
else{var c=jQuery('.variation_list[groupid="'+o.id+'"]'),s='';if(c.length>0){e.each(c,function(e,t){var n=t.getAttribute('availableVariations');if(n!==undefined&&n!==''){s=n.split(',')};return});if(s.length>0){var p=!1,u=!1;e.each(s,function(t,n){u=!1;e.each(c,function(e,t){if(n===t.value){u=!0;return}});if(u===!1){p=!0;return}});if(p===!1){l=!0;alert('Group : '+o.text+' already contains all the avaliable variations for this product');return!1}}}};if(!l){a(o)}})}
else{alert('Need to select some groups to add')}};function a(e){var t=jQuery('.wc4bp-group-container');jQuery('.wc4bp-group-loading').attr('style','display:inline-block');jQuery.post(wc4bp_groups.ajax_url,{'action':'wc4bp_get_group_view','group':JSON.stringify(e),'security':wc4bp_groups.search_groups_nonce,'post_id':wc4bp_groups.post_id},function(e){if(e||e==='0'){t.append(e)}
else{alert(wc4bp_groups.general_error)}}).fail(function(){alert(wc4bp_groups.general_error)}).always(function(){jQuery('.wc4bp-group-loading').attr('style','display:none')})};function o(){var e=this,t=e.getAttribute('previouSel');e.setAttribute('previouSel',e.value)};function u(){var t=this,n=t.getAttribute('groupId'),r=jQuery('.variation_list[groupId="'+n+'"]');e.each(r,function(e,n){if(n!==t){if(n.value===t.value){t.value=t.getAttribute('previouSel');return!1}}})};function c(e){jQuery(this).removeClass('wc4bp-group-error')};function s(e){e.preventDefault();var t=jQuery(this).attr('group_id');jQuery('#wc4bp_item_'+t).remove()};return{init:function(){if(document.getElementById('post')!==null||document.getElementsByClassName('entry-content')!==null){t.formActionsInit()}},formActionsInit:function(){var e=jQuery('.wc4bp-group-container');if(wc4bp_groups.is_force===undefined||wc4bp_groups.is_force===''){jQuery('#post').on('click',n)}
else{jQuery('.bf-submit').click(n)};jQuery('.add_groups').on('click',i);e.on('change','.variation_list',u);e.on('click','.variation_list',o);e.on('click','.wc4bp-group-item',c);e.on('click','.wc4bp-group-group-remove',s)}}};var t=r();jQuery(document).ready(function(e){t.init()})}catch(i){window.console.log(i)}});